(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{"165a":function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",{attrs:{padding:""}},[s("div",{staticClass:"row q-mb-lg"},[s("q-input",{staticClass:"col",attrs:{placeholder:"Create New Role"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createRole(t)}},model:{value:e.role,callback:function(t){e.role=t},expression:"role"}}),s("q-btn",{attrs:{color:"primary",size:"sm",label:"Create"},on:{click:e.createRole}})],1),s("div",{staticClass:"row"},[s("q-list",{staticClass:"col",attrs:{bordered:"",highlight:""}},[s("q-item-label",{attrs:{header:""}},[s("div",{staticClass:"row"},[e._v("\n          Roles\n          "),s("q-space"),s("q-icon",{attrs:{color:"primary",name:"refresh",side:""},on:{click:function(t){return e.fetchRoles()}}})],1)]),e._l(e.roles,(function(t,o){return s("q-item",{key:o},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{color:"primary",name:"security"}})],1),s("q-item-section",[e._v(e._s(t))]),s("q-item-section",{attrs:{side:"",clickable:""},on:{click:function(s){return e.deleteRole(t)}}},[s("q-icon",{attrs:{name:"delete",color:"red"}})],1)],1)}))],2)],1)])},l=[],i=(s("e6cf"),s("ddb0"),s("cf57"));s("bc3a");const n=s("1712").to,r=s("ff00"),a=s("547a").default;var c={name:"Roles",components:{},async created(){a.setSettings({TBURL:r["TB_URL"]}),a.setSettings(r);let[e,t]=await n(a.isLoggedIn());e?window.location.assign("#/"):[e,t]=await n(this.fetchRoles())},data(){return{role:"",roles:[],rolesObj:{},allRoles:[]}},methods:{alert(e){alert(e)},async createRole(){return new Promise((async(e,t)=>{if(""===this.role)return this.$q.notify({type:"negative",message:"Role cannot be blank"}),t("role cannot be blank");this.working=!0,this.showCustom();let[s,o]=await n(a.createRole(this.role));if(this.working=!1,s)this.$q.notify({type:"negative",message:s.msg||s}),e(!1);else{console.log(o),this.rolesObj=o.roles;let e=[];for(let s in this.rolesObj)e.push(this.rolesObj[s].name);this.allRoles=e;let t=[];this.roles=this.allRoles.filter((e=>!t.includes(e.name))),this.role=""}}))},async fetchRoles(){return new Promise((async(e,t)=>{this.working=!0,this.showCustom();let[s,o]=await n(a.fetchRoles());if(this.working=!1,s)this.$q.notify({type:"negative",message:s}),e(!1);else{this.rolesObj=o.roles;let t=[];for(let e in this.rolesObj)t.push(this.rolesObj[e].name);this.allRoles=t;let s=[];this.roles=this.allRoles.filter((e=>!s.includes(e.name))),e(o.roles)}}))},async deleteRole(e){let t;for(let s in this.rolesObj){let o=this.rolesObj[s];o.name===e&&(t=o.id)}return new Promise((async(s,o)=>{let[l,i]=await n(this.confirm(`Are you sure you want to delete ${e}`,"Delete Role"));return l?s(!1):(this.working=!0,this.showCustom(),[l,i]=await n(a.deleteRole(e,t)),this.working=!1,l?(console.log(l),this.$q.notify({type:"negative",message:l.msg||l}),s(!1)):(this.roles=i.roles,void s(i.roles)))}))},async confirm(e,t="Confirm"){return new Promise(((s,o)=>{this.$q.dialog({title:t,message:e,cancel:!0,persistent:!0}).onOk((()=>s(!0))).onOk((()=>s(!0))).onCancel((()=>o(!0))).onDismiss((()=>o(!0)))}))},showCustom(e=""){const t=this.$q.dialog({title:e,message:"",progress:{spinner:i["a"],color:"primary"},persistent:!0,ok:!1}),s=setInterval((()=>{!1===this.working&&(clearInterval(s),t.hide())}),500)}}},h=c,m=s("2877"),u=s("9989"),d=s("27f9"),f=s("9c40"),g=s("1c1c"),w=s("0170"),p=s("2c91"),y=s("0016"),b=s("66e5"),k=s("4074"),R=s("eebe"),q=s.n(R),v=Object(m["a"])(h,o,l,!1,null,null,null);t["default"]=v.exports;q()(v,"components",{QPage:u["a"],QInput:d["a"],QBtn:f["a"],QList:g["a"],QItemLabel:w["a"],QSpace:p["a"],QIcon:y["a"],QItem:b["a"],QItemSection:k["a"]})}}]);